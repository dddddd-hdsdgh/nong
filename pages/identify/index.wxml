<!-- 病虫害识别页面 -->
<view class="container">
  <view class="header">
    <text class="title">病虫害识别</text>
  </view>
  
  <view class="content">
    <!-- 相机/图片预览区域 -->
    <view class="camera-area">
      <!-- 无图片状态 -->
      <text wx:if="{{!imageTempPath && !showResult}}">点击下方按钮拍照或上传图片</text>
      
      <!-- 图片预览 -->
      <image 
        wx:if="{{imageTempPath && !showResult}}" 
        src="{{imageTempPath}}" 
        mode="aspectFill"
        class="preview-image"
      ></image>
      
      <!-- 识别中状态 - 由wx.showLoading处理 -->
    </view>
    
    <!-- 操作按钮组 -->
    <view class="action-buttons" wx:if="{{!showResult}}">
      <button bindtap="takePhoto" disabled="{{loading}}">拍照识别</button>
      <button bindtap="chooseImage" disabled="{{loading}}">从相册选择</button>
    </view>
    
    <!-- 状态提示 -->
    <text class="status-text" wx:if="{{!loading && !imageTempPath && !showResult}}">准备就绪，点击按钮开始识别</text>
    
    <!-- 识别结果展示区域 -->
    <view class="result-container" wx:if="{{showResult && result}}">
      <view class="result-title">识别结果</view>
      
      <!-- 显示上传的图片 -->
      <image 
        src="{{imageTempPath}}" 
        mode="aspectFill"
        class="result-image"
      ></image>
      
      <view class="result-content">
        <view class="result-item">
          <text class="label">病害名称：</text>
          <text class="value">{{result.diseaseName}}</text>
        </view>
        
        <view class="result-item">
          <text class="label">置信度：</text>
          <text class="value">{{result.confidence ? (result.confidence * 100).toFixed(1) + '%' : '-'}}</text>
        </view>
        
        <view class="result-section" wx:if="{{result.description}}">
          <text class="section-title">病害描述</text>
          <text class="description">{{result.description}}</text>
        </view>
        
        <view class="result-section" wx:if="{{result.symptoms}}">
          <text class="section-title">症状表现</text>
          <text class="description">{{result.symptoms}}</text>
        </view>
        
        <view class="result-section" wx:if="{{result.prevention}}">
          <text class="section-title">防治建议</text>
          <text class="description">{{result.prevention}}</text>
        </view>
      </view>
      
      <!-- 结果操作按钮 -->
      <view class="result-actions">
        <button bindtap="saveResult" type="primary">保存结果</button>
        <button bindtap="viewDiseaseDetail" type="default">查看详情</button>
        <button bindtap="reIdentify" type="warn">重新识别</button>
      </view>
    </view>
  </view>
</view>