<!-- pages/search/index.wxml -->
<view class="search-container">
  <!-- æœç´¢æ  -->
  <view class="search-header">
    <view class="search-input-wrapper">
      <input 
        class="search-input" 
        placeholder="æœç´¢çŸ¥è¯†ã€é—®é¢˜æˆ–å…³é”®è¯..." 
        value="{{keyword}}"
        bindinput="onInputChange"
        confirm-type="search"
        bindconfirm="onSearchTap"
      />
      <view class="search-btn" bindtap="onSearchTap">
        <text class="search-btn-text">æœç´¢</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢å†å²å’Œçƒ­é—¨æœç´¢ -->
  <view class="search-suggestions" wx:if="{{!loading && articles.length === 0 && !error}}">
    <!-- æœç´¢å†å² -->
    <view class="suggestion-section" wx:if="{{searchHistory.length > 0}}">
      <view class="section-header">
        <text class="section-title">æœç´¢å†å²</text>
        <text class="clear-btn" bindtap="clearSearchHistory">æ¸…é™¤</text>
      </view>
      <view class="history-tags">
        <view 
          class="history-tag" 
          wx:for="{{searchHistory}}" 
          wx:key="index"
          bindtap="onHistoryTap"
          data-keyword="{{item}}"
        >
          <text>{{item}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading && articles.length === 0}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">æœç´¢ä¸­...</text>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view class="error-container" wx:elif="{{error}}">
    <text class="error-icon">âš ï¸</text>
    <text class="error-text">{{error}}</text>
    <button class="retry-btn" bindtap="onSearchTap">é‡æ–°æœç´¢</button>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view class="search-results" wx:else>
    <!-- æœç´¢ç»“æœç»Ÿè®¡ -->
    <view class="result-header" wx:if="{{articles.length > 0}}">
      <text class="result-count">æ‰¾åˆ° {{articles.length}} æ¡ç»“æœ</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-container" wx:if="{{articles.length === 0 && !loading && keyword}}">
      <text class="empty-icon">ğŸ”</text>
      <text class="empty-text">æœªæ‰¾åˆ°ç›¸å…³æ–‡ç« </text>
      <text class="empty-tip">è¯•è¯•å…¶ä»–å…³é”®è¯å§</text>
    </view>

    <!-- æ–‡ç« åˆ—è¡¨ -->
    <view class="article-list" wx:if="{{articles.length > 0}}">
      <view wx:for="{{articles}}" wx:key="id" class="article-item">
        <view class="article-content" bindtap="navigateToDetail" data-id="{{item.id}}">
          <!-- æ–‡ç« æ ‡é¢˜å’Œæ‘˜è¦ -->
          <view class="article-info">
            <text class="article-title">{{item.title}}</text>
            <text class="article-summary">{{item.summary || ''}}...</text>
            
            <!-- æ–‡ç« å…ƒä¿¡æ¯ -->
            <view class="article-meta">
              <text class="category" wx:if="{{item.categoryName}}">{{item.categoryName}}</text>
              <text class="dot" wx:if="{{item.categoryName}}">Â·</text>
              <text class="date">{{item.publishDate || '2024-01-01'}}</text>
              <text class="dot">Â·</text>
              <text class="view-count">{{item.viewCount || 0}} æµè§ˆ</text>
            </view>
          </view>
          
          <!-- æ–‡ç« å°é¢å›¾ -->
          <image class="article-cover" wx:if="{{item.coverImage}}" src="{{item.coverImage}}" mode="aspectFill"></image>
        </view>
        
        <!-- æ“ä½œæ  -->
        <view class="article-action">
          <view class="action-item" bindtap="toggleFavorite" data-id="{{item.id}}">
            <image class="action-icon" src="{{item.isFavorite ? '/static/icons/favorite-active.png' : '/static/icons/favorite.png'}}" mode="aspectFit"></image>
            <text class="action-text">{{item.likeCount || 0}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{loading && articles.length > 0}}">
      <view class="loading-small-spinner"></view>
      <text class="load-more-text">åŠ è½½æ›´å¤š...</text>
    </view>

    <!-- æ²¡æœ‰æ›´å¤š -->
    <view class="no-more" wx:if="{{!loading && !hasMore && articles.length > 0}}">
      <text class="no-more-text">æ²¡æœ‰æ›´å¤šå†…å®¹äº†</text>
    </view>
  </view>
</view>

