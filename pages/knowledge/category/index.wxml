<!-- pages/knowledge/category/index.wxml -->

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:if="{{loading && articles.length === 0}}">
  <view class="loading-spinner"></view>
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>

<!-- é”™è¯¯çŠ¶æ€ -->
<view class="error-container" wx:elif="{{error}}">
  <text class="error-icon">âš ï¸</text>
  <text class="error-text">{{error}}</text>
  <button class="retry-btn" bindtap="loadArticles" data-refresh="true">é‡æ–°åŠ è½½</button>
</view>

<!-- æ–‡ç« åˆ—è¡¨ -->
<view class="article-list" wx:else>
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{articles.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“„</text>
    <text class="empty-text">è¯¥åˆ†ç±»ä¸‹æš‚æ— æ–‡ç« </text>
  </view>
  
  <!-- æ–‡ç« åˆ—è¡¨ -->
  <view wx:for="{{articles}}" wx:key="id" class="article-item">
    <view class="article-content" bindtap="navigateToDetail" data-id="{{item.id}}">
      <!-- æ–‡ç« æ ‡é¢˜å’Œæ‘˜è¦ -->
      <view class="article-info">
        <text class="article-title">{{item.title}}</text>
        <text class="article-summary">{{item.summary || ''}}...</text>
        
        <!-- æ–‡ç« å…ƒä¿¡æ¯ -->
        <view class="article-meta">
          <text class="author">{{item.author || 'å†œä¸šä¸“å®¶'}}</text>
          <text class="dot">Â·</text>
          <text class="date">{{item.createdAt || '2024-01-01'}}</text>
          <text class="dot">Â·</text>
          <text class="view-count">{{item.viewCount || 0}} æµè§ˆ</text>
        </view>
      </view>
      
      <!-- æ–‡ç« å°é¢å›¾ -->
      <image class="article-cover" wx:if="{{item.coverImage}}" src="{{item.coverImage}}" mode="aspectFill"></image>
    </view>
    
    <!-- æ“ä½œæ  -->
    <view class="article-action">
      <view class="action-item" bindtap="toggleFavorite" data-id="{{item.id}}">
        <image class="action-icon" src="{{item.isFavorite ? '/static/icons/favorite-active.png' : '/static/icons/favorite.png'}}" mode="aspectFit"></image>
        <text class="action-text">{{item.likeCount || 0}}</text>
      </view>
    </view>
  </view>
  
  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{loading && articles.length > 0}}">
    <view class="loading-small-spinner"></view>
    <text class="load-more-text">åŠ è½½æ›´å¤š...</text>
  </view>
  
  <!-- æ²¡æœ‰æ›´å¤š -->
  <view class="no-more" wx:if="{{!loading && !hasMore && articles.length > 0}}">
    <text class="no-more-text">æ²¡æœ‰æ›´å¤šå†…å®¹äº†</text>
  </view>
</view>