# 知识库搜索功能使用指南

## 如何使用搜索功能

### 1. 进入搜索页面

有两种方式可以进入搜索页面：

**方式一：从知识库首页**
- 打开知识库页面（底部导航栏的"知识库"）
- 点击页面顶部的搜索框
- 自动跳转到搜索页面

**方式二：直接导航**
- 在代码中可以通过以下方式跳转：
```javascript
wx.navigateTo({
  url: '/pages/search/index'
});
```

### 2. 执行搜索

在搜索页面：
1. 在搜索输入框中输入关键词（例如："病虫害"、"防治"、"农业"等）
2. 点击"搜索"按钮，或按键盘上的"搜索/确认"键
3. 等待搜索结果加载

### 3. 搜索功能特点

- **智能匹配**：会同时搜索文章的标题和内容
- **优先级排序**：标题匹配的文章会优先显示
- **实时搜索**：输入关键词后立即搜索
- **搜索历史**：自动保存最近10条搜索记录
- **分页加载**：支持下拉刷新和上拉加载更多

### 4. 搜索技巧

1. **使用关键词**：输入文章标题或内容中的关键词
2. **简洁搜索**：使用简短的关键词效果更好
3. **查看历史**：点击搜索历史中的关键词可以快速搜索
4. **清除历史**：点击"清除"按钮可以删除所有搜索历史

### 5. 搜索结果说明

搜索结果会显示：
- **文章标题**：匹配的文章标题
- **文章摘要**：文章的前100个字符
- **分类信息**：文章所属的分类
- **发布时间**：文章的发布时间
- **浏览量**：文章的浏览次数
- **收藏按钮**：可以收藏喜欢的文章

### 6. 常见问题

**Q: 为什么搜索不到结果？**

A: 可能的原因：
1. 数据库中还没有文章数据
2. 关键词与文章标题/内容不匹配
3. 网络连接问题

**解决方法**：
- 检查数据库中是否有 `knowledge_articles` 表的数据
- 尝试使用更通用的关键词（如"农业"、"技术"等）
- 查看浏览器控制台的错误信息

**Q: 如何查看搜索日志？**

A: 打开微信开发者工具的控制台，可以看到：
- `开始搜索，关键词: xxx`
- `获取到文章总数: xxx`
- `标题匹配: xxx 内容匹配: xxx`
- `搜索结果总数: xxx`

**Q: 搜索功能支持哪些字符？**

A: 支持中文、英文、数字和常见标点符号。搜索不区分大小写。

### 7. 技术实现

搜索功能使用客户端过滤的方式：
1. 从 Supabase 获取文章列表（最多200条）
2. 在客户端使用 JavaScript 进行关键词匹配
3. 优先显示标题匹配的文章
4. 然后显示内容匹配的文章
5. 按发布时间倒序排列

这种方式虽然需要获取更多数据，但可以确保搜索功能的稳定性和可靠性。

### 8. 调试方法

如果搜索功能不工作，请检查：

1. **数据库连接**
   - 确认 Supabase 配置正确
   - 检查网络请求是否成功

2. **数据表结构**
   - 确认 `knowledge_articles` 表存在
   - 检查表中有数据

3. **控制台日志**
   - 打开微信开发者工具
   - 查看 Console 标签页
   - 查找搜索相关的日志信息

4. **测试步骤**
   ```
   1. 打开搜索页面
   2. 输入一个简单的关键词（如"农业"）
   3. 点击搜索
   4. 查看控制台输出
   5. 检查是否有错误信息
   ```

### 9. 示例搜索

以下是一些示例搜索关键词：
- "病虫害" - 搜索病虫害相关内容
- "防治" - 搜索防治方法
- "农业" - 搜索农业相关知识
- "技术" - 搜索技术文章
- "种植" - 搜索种植相关文章

---

**注意**：如果搜索仍然无法正常工作，请检查：
1. 数据库中是否有文章数据
2. 文章数据是否包含 `title` 和 `content` 字段
3. 网络连接是否正常
4. Supabase 配置是否正确

